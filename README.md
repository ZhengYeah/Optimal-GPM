# OGPM

Code for paper: [PETS'25] Optimal Piecewise-based Mechanism for Collecting Bounded Numerical Data under Local Differential Privacy

**Contributions:** 

* The first work to study the optimality of the piecewise-based mechanism under its most general form.
* The closed-form optimal mechanisms for classical domains and circular domains.

## Code Structure

We encode the solving of the optimal $m$-piece mechanism under a distance metric as a *bilinear* optimization problem and solve it using the Gurobi solver.
The solving class for each distance metric can be found in the `src` folder.
Now we support the following distance metrics:
- $L_1$ distance (absolute error)
- $L_2$ distance (squared error)
- Wasserstein distance (a distribution distance, not used in the paper)

The main folders and files are as follows:

```
|- src (solving classes for different distance metrics)
|- experiments (theoretical and experimental evaluations in the paper)
|- validation (validation of the optimal mechanism)
|- PM.py (the PM mechanism and its variants)
|- SW.py (the SW mechanism and its variants)
```

## Reproduction 

To reproduce the results in the paper, you need to install the required packages listed in `pyproject.toml`.
We recommend using the `uv` package management system to create a virtual environment.
To install `uv`, refer to the [uv installation](https://docs.astral.sh/uv/).

The evaluation section of the paper can be reproduced by running the scripts in the `experiments` folder.
Specifically, the scripts are organized as follows:

```
|- experiments
  |- theoretical
    |- classical_domain
      |- whole-domain_L1.py: Figure 8
      |- worst-case_L1.py, worst-case_L2.py: Figure 9
      |- comparison_truncated_and_staircase: Figure 13 and 14
      |- small_epsilon: Figure 20 in the appendix
    |- circular_domain
      |- whole-domain_circular_L2.py: Figure 10
      |- worst-case_circular_L1.py, worst-case_circular_L2.py: Figure 11
      |- comparison_purkayastha: Figure 15
    |- ablation
      |- ablation-whole-domain_L2_PM.py: Figure 12(a)
      |- ablation-whole-domain_L2_SW.py: Figure 12(b)
  |- experimental
    |- distribution_classical.py, distribution_circular.py: Figure 16
    |- mean_classical.py, mean_circular.py: Figure 17
```

The above scripts will generate `.csv` files containing the results, which are also included in corresponding folders.
Then the PDF plots can be generated by running the scripts beginning with `draw_*` in the same folder.

## Choice 2: 
